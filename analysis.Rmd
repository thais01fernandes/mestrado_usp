---
title: Exploratory Analysis of Municipalities in Brazil that have adopted a Fare Free
  Public Transport
author: "Thais Pereira"
date: "`r format(Sys.Date(), format='%d/%m/%Y')`"
output:
  theme: flatly
  df_print: paged
  highlight: tango
  html_document:
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}

(knitr::opts_chunk$set(
	echo = FALSE,
	error = FALSE,
	message = FALSE,
	warning = FALSE
)
) 
```

```{css}

@import url('https://fonts.googleapis.com/css2?family=Lora:wght@500&display=swap');

h1.title{ 
    font-family: 'Lora', serif;
    color: #bf7d70
    font-size: 30px;
    text-align: center;
    font-weight: bold;
}

h4.author{ 
    font-family: 'Lora', serif;
    color: #bf7d70;
    font-size: 20px;
    text-align: center;
    font-weight: bold;
}

h4.date{ 
    font-family: 'Lora', serif;
    color: #bf7d70;
    font-size: 12px;
    text-align: center;
    font-weight: bold;
}

p{
  font-family: 'Lora', serif;
  text-align: justify;
  font-size: 13px
}


h2 {
  font-family: 'Lora', serif;
  font-size: 15px;
  text-align: justify;
}


.btn {
    border-width: 0 0px 0px 0px;
    font-weight: normal;
    text-transform: ;
}
.btn-default {
    color: #2ecc71;
    background-color: #ffffff;
    border-color: #ffffff;
}


h1, .h1, h2, .h2, h3, .h3 , h4, .h4, h5, .h5, h6, .h6, h7, .h7, h8, .h8 {
    margin-top: 40px;
}


```


```{r Pacotes}


library("tidyverse")
library("kableExtra")
library("knitr")
library("tidylog")
library("readxl")
library("geobr")
library("sf")
library("wesanderson")
library("ggplot2")
library("stringr")
library ("abjData")
library("extrafont")
library("lubridate")
library("transformr")
library("reactable")
library("rnaturalearth")
library("rgeos")
library("plotly")
library("ggrepel")
library('googlesheets4')
library("leaflet")
library('ggthemes')
library('rmdformats')


```


```{r Baixando os dados}

file1 <- "https://raw.githubusercontent.com/thais01fernandes/mestrado_usp/main/dados/banco_completo"
banco_completo <- read_delim(file1, delim = ",", 
                        locale = locale(encoding='latin1')) %>% select(-1)


```

## 1. Tabela com dados a respeio dos municípios que implementaram a política até março de 2023

```{r Tabela inicial, fig.align = 'center', out.width = "60%"}

# tabela de apresentação dos municípios estudados 
# tabela com reactable: 
  
  options(scipen=999)
  banco_completo_5  %>% 
  filter(tarifa_zero == "sim") %>% 
  select(uf, nome_muni, classe_pop, 
         Pib_Municipal_2018, renda_percapta_media, pct_pobres, prosperidade_social,  
         taxa_atividade_18_anos_ou_mais, taxa_urbanizacao, area_territorial, densidade_demografica, ocup_desl, taxa_pop_vulneravel_retorna_diariamente_trabalho, 
         indice_gini, indice_theil, idhm_class, idhm_e_class, idhm_r_class, idhm_l_class, ivs_class, ivs_infra_urbana_class, ivs_cap_class, ivs_renda_trab_class) %>% 
  mutate_if(is.character, str_to_title) %>% 
  mutate(pct_pobres = pct_pobres/100, taxa_atividade_18_anos_ou_mais = taxa_atividade_18_anos_ou_mais/100,
         ocup_desl = ocup_desl/100) %>% 
  reactable(
      defaultPageSize = 5,
      searchable = TRUE,
      outlined = FALSE, 
      showPageInfo = TRUE, 
      showPageSizeOptions = TRUE,
      defaultColDef = colDef(
      align = "center",
      headerStyle = list(background = "#f7f7f8")),
      columns = list(
      uf = colDef("Federative Unit", minWidth = 105, align = "center"),
      nome_muni = colDef("City", minWidth = 120, align = "center"),
      classe_pop = colDef("Population Class",  minWidth = 120, align = "center"),
      Pib_Municipal_2018 = colDef("GDP per Capta" , format = colFormat(prefix = "R$ ", separators = TRUE), minWidth = 120),
      renda_percapta_media = colDef("Average Per Capta Income" , format = colFormat(prefix = "R$ ", separators = TRUE), minWidth = 150),
      prosperidade_social = colDef("Social Prosperity", minWidth = 130),
      pct_pobres = colDef("% of Poor" ,  format = colFormat(percent = TRUE, digits = 1), minWidth = 120), 
      taxa_atividade_18_anos_ou_mais = colDef("Economically Active Pouplation (18+)" , format = colFormat(percent = TRUE, digits = 1), minWidth = 200),
      taxa_urbanizacao = colDef("Urbanization Rate" , format = colFormat(percent = TRUE, digits = 1), minWidth = 120),
      ocup_desl = colDef("% of vulnerable to poverty who spend more than an hour to work" , format = colFormat(percent = TRUE, digits = 1), minWidth = 250),
      taxa_pop_vulneravel_retorna_diariamente_trabalho = colDef("% of the employed population vulnerable to poverty that return daily from work" , 
                                                                format = colFormat(percent = TRUE, digits = 1), minWidth = 250), 
      indice_gini = colDef("Gini" ,  minWidth = 100),
      indice_theil = colDef("Theil-L" ,  minWidth = 100),
      idhm_class = colDef("Municipal Human Development Index (MHDI)" ,  minWidth = 150),
      idhm_e_class = colDef("MHDI Education" ,  minWidth = 100),
      idhm_r_class = colDef("MHDI Income" ,  minWidth = 100), 
      idhm_l_class  = colDef("MHDI Longevidade" , minWidth = 120),
      ivs_class = colDef("Social Vulnerability Index (SVI)" , minWidth = 150), 
      ivs_infra_urbana_class = colDef("SVI Urban Infrastructure" , minWidth = 150), 
      ivs_cap_class = colDef("SVI Human Capital" , minWidth = 150), 
      ivs_renda_trab_class = colDef("SVI Income and Work" , minWidth = 150), 
      area_territorial = colDef("Territorial Area" , format = colFormat(suffix = " km²", separators = TRUE), minWidth = 150),
      densidade_demografica = colDef("Demographic Density" , format = colFormat(suffix = " hab/km²", separators = TRUE, digits = 3), minWidth = 150),
      pageSizeOptions = c(5,10,15,20,25,30), bordered = TRUE, striped = FALSE, highlight = TRUE))
     
```









